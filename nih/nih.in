#!/bin/sh

set -e 

export LC_ALL=C

usage (){
    cat 1>&2 <<'EOF'
blablabla help, see README
EOF
}

sysconfdir=${NIH_SYSCONFDIR-@sysconfdir@}/nih
libexecdir=${NIH_LIBEXECDIR-@libexecdir@}
confdir=$HOME/.nih

# loading config files
if test -r "$sysconfdir/config"; then
    conffile="$sysconfdir/config"
elif test -r "$confdir/config"; then
    conffile="$confdir/config"
else
    cat <<EOF
Neither $sysconfdir/config not $confdir/config are readable.
Sorry, I cannot help.
EOF
    exit 1
fi

. "$conffile"

# handling global options
while getopts hV f
do
    case $f in
	h)      usage; exit 0;;
	V)      echo pkgnih @VERSION@;;
	'?')    usage; exit 1;;
    esac
done
shift `expr $OPTIND - 1`

if test $# -eq 0; then
    usage
    exit 1
fi

# handling commands

######################################################################
# help
if test "$1" = help; then
    usage
    exit 0
fi

######################################################################
# refresh
if test "$1" = refresh; then
    exit 0
fi

######################################################################
# install | upgrade
if test "$1" = install -o test "$1" = upgrade; then
    exit 0
fi

######################################################################
# uninstall | remove | delete
if test "$1" = uninstall -o test "$1" = remove -o test "$1" = delete; then
    exit 0
fi

######################################################################
# verify
if test "$1" = verify; then
    exit 0
fi

######################################################################
# status
if test "$1" = status; then
    exit 0
fi

######################################################################
# audit
if test "$1" = audit; then
    exit 0
fi

######################################################################
# search
if test "$1" = search; then
    exit 0
fi

######################################################################
# leaf
if test "$1" = leaf; then
    exit 0
fi

######################################################################
# list
if test "$1" = list; then
    exit 0
fi

######################################################################
# license
if test "$1" = license; then
    exit 0
fi

######################################################################
# <bad> command
echo "Unknown command '$1', see nih -h for more information" 1>&2
exit 2
